<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FOCUS Tools: Basic Usage • focustools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="FOCUS Tools: Basic Usage">
<meta property="og:description" content="focustools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">focustools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/focustools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="focustools_files/header-attrs-2.5/header-attrs.js"></script><link href="focustools_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="focustools_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>FOCUS Tools: Basic Usage</h1>
            <h3 class="subtitle">
<em>Fo</em>recasting <em>C</em>OVID-19 in the <em>US</em>
</h3>
            
      
      
      <div class="hidden name"><code>focustools.Rmd</code></div>

    </div>

    
    
<p>Here we provide an example of how to use <code>focustools</code> to generate forecasts for COVID-19 Forecast Hub targets via time series approaches. First, load the <code>focustools</code> package and other ancillary packages.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">focustools</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">readr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">purrr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fabletools</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fable</span>)</pre></body></html></div>
<div id="get-data" class="section level2">
<h2 class="hasAnchor">
<a href="#get-data" class="anchor"></a>Get data</h2>
<p>First, let’s retrieve COVID-19 data from the JHU source. Note that the <code><a href="../reference/retrieve.html">get_cases()</a></code> and <code><a href="../reference/retrieve.html">get_deaths()</a></code> functions are executed separately, then joined and converted to a <a href="https://otexts.com/fpp3/tsibbles.html"><code>tsibble</code></a>. Note that <code>granularity="state"</code> would pull in data at the state and territory level.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">## get data at the national scale from jhu source</span>
<span class="no">usac</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="../reference/retrieve.html">get_cases</a></span>(<span class="kw">source</span><span class="kw">=</span><span class="st">"jhu"</span>,  <span class="kw">granularity</span> <span class="kw">=</span> <span class="st">"national"</span>)
<span class="no">usad</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/retrieve.html">get_deaths</a></span>(<span class="kw">source</span><span class="kw">=</span><span class="st">"jhu"</span>,  <span class="kw">granularity</span> <span class="kw">=</span> <span class="st">"national"</span>)

<span class="co">## use the focustools helper to prep the tsibble format</span>
<span class="no">usa</span> <span class="kw">&lt;-</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span>(<span class="no">usac</span>, <span class="no">usad</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"location"</span>, <span class="st">"epiyear"</span>, <span class="st">"epiweek"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/make_tsibble.html">make_tsibble</a></span>(<span class="kw">chop</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
</div>
<div id="fit-time-series-models" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-time-series-models" class="anchor"></a>Fit time series models</h2>
<p>With the data prepared, we can now fit the models. In this case, we’ll fit two models. One will be an ARIMA of incident cases, with parameters automatically optimized. For more details see <code><a href="https://fable.tidyverts.org/reference/ARIMA.html">?fable::ARIMA</a></code>. In this case we will restrict the order of non-seasonal auto-regressive terms, order of integration for non-seasonal differencing, and order of non-seasonal moving average terms. The other model will use the three week lagged incident case counts to predict incident deaths:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Fit incident case model</span>
<span class="no">fits.icases</span>  <span class="kw">&lt;-</span> <span class="no">usa</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://fabletools.tidyverts.org/reference/model.html">model</a></span>(<span class="kw">arima</span> <span class="kw">=</span> <span class="fu"><a href="https://fable.tidyverts.org/reference/ARIMA.html">ARIMA</a></span>(<span class="no">icases</span>~<span class="fu">PDQ</span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>)+<span class="fu">pdq</span>(<span class="fl">1</span>:<span class="fl">2</span>,<span class="fl">0</span>:<span class="fl">2</span>,<span class="fl">0</span>), <span class="kw">stepwise</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">approximation</span><span class="kw">=</span><span class="fl">FALSE</span>))

<span class="co"># Fit incident death model based on cases three weeks ago</span>
<span class="no">fits.ideaths</span> <span class="kw">&lt;-</span> <span class="no">usa</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://fabletools.tidyverts.org/reference/model.html">model</a></span>(<span class="kw">linear_caselag3</span> <span class="kw">=</span> <span class="fu"><a href="https://fable.tidyverts.org/reference/TSLM.html">TSLM</a></span>(<span class="no">ideaths</span> ~ <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span>(<span class="no">icases</span>, <span class="fl">3</span>)))</pre></body></html></div>
</div>
<div id="generate-forecasts" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-forecasts" class="anchor"></a>Generate forecasts</h2>
<p>With the model fit objects created, we can generate forecasts (including point and quantile estimates) for the outcomes of interest at an arbitrary horizon (here, 4 weeks). Note that given the model we have chosen for the incident deaths outcome, we do need to make sure to generate the incident case forecast <em>first</em> so that we can retrieve point estimates for future cases, which will be passed into the incident deaths forecast:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## generate incident case forecast</span>
<span class="no">forc.icases</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ts_forecast.html">ts_forecast</a></span>(<span class="no">fits.icases</span>, <span class="kw">outcome</span> <span class="kw">=</span> <span class="st">"icases"</span>, <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">4</span>)

<span class="co">## need to get future cases to pass to ideaths forecast</span>
<span class="no">futr.icases</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ts_futurecases.html">ts_futurecases</a></span>(<span class="no">usa</span>, <span class="no">forc.icases</span>, <span class="kw">horizon</span> <span class="kw">=</span> <span class="fl">4</span>)

<span class="co"># Forecast incident deaths based on best guess for cases</span>
<span class="no">forc.ideaths</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ts_forecast.html">ts_forecast</a></span>(<span class="no">fits.ideaths</span>,  <span class="kw">outcome</span> <span class="kw">=</span> <span class="st">"ideaths"</span>, <span class="kw">new_data</span> <span class="kw">=</span> <span class="no">futr.icases</span>)</pre></body></html></div>
<p>We can use the forecasts of incident deaths to infer cumulative deaths. The <code><a href="../reference/ts_forecast.html">ts_forecast()</a></code> function is flexible enough to switch methods internally, requiring a “inc_forecast” parameter if either “cdeaths” or “ccases” is passed as the “outcome” for the forecast:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">## generate cumulative death forecast</span>
<span class="no">forc.cdeaths</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ts_forecast.html">ts_forecast</a></span>(<span class="kw">outcome</span> <span class="kw">=</span> <span class="st">"cdeaths"</span>, <span class="kw">.data</span> <span class="kw">=</span> <span class="no">usa</span>, <span class="kw">inc_forecast</span> <span class="kw">=</span> <span class="no">forc.ideaths</span>)</pre></body></html></div>
</div>
<div id="prepare-for-submission" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-for-submission" class="anchor"></a>Prepare for submission</h2>
<p>Prior to <a href="https://github.com/reichlab/covid19-forecast-hub/blob/708ea2b0e34ecb03afb82a62eb9bf5a1b4b97222/data-processed/README.md">submitting these forecasts to the COVID-19 Forecast Hub</a> we need to prepare them in the <a href="https://github.com/reichlab/covid19-forecast-hub/blob/master/data-processed/README.md#forecast-file-format">canonical submission format</a>. Data prep in <code>format_for_submission</code> includes naming targets appropriately and ensuring that target dates adhere to epidemiological week format:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co">## create submission object</span>
<span class="no">submission</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="../reference/format_for_submission.html">format_for_submission</a></span>(<span class="no">forc.icases</span>,  <span class="kw">target_name</span> <span class="kw">=</span> <span class="st">"inc case"</span>),
         <span class="fu"><a href="../reference/format_for_submission.html">format_for_submission</a></span>(<span class="no">forc.ideaths</span>, <span class="kw">target_name</span> <span class="kw">=</span> <span class="st">"inc death"</span>),
         <span class="fu"><a href="../reference/format_for_submission.html">format_for_submission</a></span>(<span class="no">forc.cdeaths</span>, <span class="kw">target_name</span> <span class="kw">=</span> <span class="st">"cum death"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span>(<span class="no">bind_rows</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">target</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">submission</span>)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   forecast_date target           target_end_date location type   quantile  value</span>
<span class="co">#&gt;   &lt;date&gt;        &lt;glue&gt;           &lt;date&gt;          &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">#&gt; 1 2021-03-29    1 wk ahead cum … 2021-04-03      US       point    NA     556853</span>
<span class="co">#&gt; 2 2021-03-29    1 wk ahead cum … 2021-04-03      US       quant…    0.01  548945</span>
<span class="co">#&gt; 3 2021-03-29    1 wk ahead cum … 2021-04-03      US       quant…    0.025 550191</span>
<span class="co">#&gt; 4 2021-03-29    1 wk ahead cum … 2021-04-03      US       quant…    0.05  551262</span>
<span class="co">#&gt; 5 2021-03-29    1 wk ahead cum … 2021-04-03      US       quant…    0.1   552497</span>
<span class="co">#&gt; 6 2021-03-29    1 wk ahead cum … 2021-04-03      US       quant…    0.15  553330</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">submission</span>)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   forecast_date target           target_end_date location type    quantile value</span>
<span class="co">#&gt;   &lt;date&gt;        &lt;glue&gt;           &lt;date&gt;          &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 2021-03-29    4 wk ahead inc … 2021-04-24      US       quanti…    0.8   11774</span>
<span class="co">#&gt; 2 2021-03-29    4 wk ahead inc … 2021-04-24      US       quanti…    0.85  12436</span>
<span class="co">#&gt; 3 2021-03-29    4 wk ahead inc … 2021-04-24      US       quanti…    0.9   13268</span>
<span class="co">#&gt; 4 2021-03-29    4 wk ahead inc … 2021-04-24      US       quanti…    0.95  14503</span>
<span class="co">#&gt; 5 2021-03-29    4 wk ahead inc … 2021-04-24      US       quanti…    0.975 15574</span>
<span class="co">#&gt; 6 2021-03-29    4 wk ahead inc … 2021-04-24      US       quanti…    0.99  16819</span></pre></body></html></div>
<p>Lastly, we can <a href="https://github.com/reichlab/covid19-forecast-hub/blob/master/data-processed/README.md#forecast-validation">validate the submission</a>. The object must be written to a file and then validated with <code><a href="../reference/validate_forecast.html">validate_forecast()</a></code>, which wraps a <a href="https://github.com/reichlab/covid19-forecast-hub/blob/708ea2b0e34ecb03afb82a62eb9bf5a1b4b97222/code/validation/test_formatting.py">python function developed and maintained by the COVID-19 Forecast Hub organizers</a>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">ffile</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>(), <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(), <span class="st">"-focustools-ts.csv"</span>))
<span class="no">submission</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span>(<span class="no">ffile</span>)
<span class="fu"><a href="../reference/validate_forecast.html">validate_forecast</a></span>(<span class="no">ffile</span>)</pre></body></html></div>
</div>
<div id="forecast-visualization-and-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#forecast-visualization-and-summary" class="anchor"></a>Forecast visualization and summary</h2>
<p>We can use <code><a href="../reference/plot_forecast.html">plot_forecast()</a></code> to visualize these forecasts:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_forecast.html">plot_forecast</a></span>(<span class="kw">.data</span><span class="kw">=</span><span class="no">usa</span>, <span class="kw">submission</span><span class="kw">=</span><span class="no">submission</span>)</pre></body></html></div>
<p><img src="focustools_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>And we can use <code><a href="../reference/submission_summary.html">submission_summary()</a></code> to produce a summary of the forecasts for each target (cumulative deaths, incident cases, incident deaths):</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">subsum</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/submission_summary.html">submission_summary</a></span>(<span class="kw">.data</span><span class="kw">=</span><span class="no">usa</span>, <span class="kw">submission</span><span class="kw">=</span><span class="no">submission</span>)
<span class="no">subsum</span>
<span class="co">#&gt; $counts</span>
<span class="co">#&gt; $counts$cdeaths</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   location Previous `1w ahead` `2w ahead` `3w ahead` `4w ahead`</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 US         548829     556853     564956     573592     582506</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts$icases</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   location Previous `1w ahead` `2w ahead` `3w ahead` `4w ahead`</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 US         432748     457428     470287     476987     480478</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts$ideaths</span>
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   location Previous `1w ahead` `2w ahead` `3w ahead` `4w ahead`</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 US           6728       8024       8102       8636       8914</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $perc_diff</span>
<span class="co">#&gt; $perc_diff$cdeaths</span>
<span class="co">#&gt; # A tibble: 1 x 5</span>
<span class="co">#&gt;   location `1w ahead` `2w ahead` `3w ahead` `4w ahead`</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     </span>
<span class="co">#&gt; 1 US       1.5%       1.5%       1.5%       1.6%      </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $perc_diff$icases</span>
<span class="co">#&gt; # A tibble: 1 x 5</span>
<span class="co">#&gt;   location `1w ahead` `2w ahead` `3w ahead` `4w ahead`</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     </span>
<span class="co">#&gt; 1 US       5.7%       2.8%       1.4%       0.7%      </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $perc_diff$ideaths</span>
<span class="co">#&gt; # A tibble: 1 x 5</span>
<span class="co">#&gt;   location `1w ahead` `2w ahead` `3w ahead` `4w ahead`</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     </span>
<span class="co">#&gt; 1 US       19.3%      1%         6.6%       3.2%</span></pre></body></html></div>
<p>We could optionally coerce this structure into a table. For counts:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">subsum</span>$<span class="no">counts</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(<span class="kw">.id</span><span class="kw">=</span><span class="st">"target"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">target</th>
<th align="left">location</th>
<th align="right">Previous</th>
<th align="right">1w ahead</th>
<th align="right">2w ahead</th>
<th align="right">3w ahead</th>
<th align="right">4w ahead</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cdeaths</td>
<td align="left">US</td>
<td align="right">548829</td>
<td align="right">556853</td>
<td align="right">564956</td>
<td align="right">573592</td>
<td align="right">582506</td>
</tr>
<tr class="even">
<td align="left">icases</td>
<td align="left">US</td>
<td align="right">432748</td>
<td align="right">457428</td>
<td align="right">470287</td>
<td align="right">476987</td>
<td align="right">480478</td>
</tr>
<tr class="odd">
<td align="left">ideaths</td>
<td align="left">US</td>
<td align="right">6728</td>
<td align="right">8024</td>
<td align="right">8102</td>
<td align="right">8636</td>
<td align="right">8914</td>
</tr>
</tbody>
</table>
<p>Or percent difference:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">subsum</span>$<span class="no">perc_diff</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(<span class="kw">.id</span><span class="kw">=</span><span class="st">"target"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">target</th>
<th align="left">location</th>
<th align="left">1w ahead</th>
<th align="left">2w ahead</th>
<th align="left">3w ahead</th>
<th align="left">4w ahead</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cdeaths</td>
<td align="left">US</td>
<td align="left">1.5%</td>
<td align="left">1.5%</td>
<td align="left">1.5%</td>
<td align="left">1.6%</td>
</tr>
<tr class="even">
<td align="left">icases</td>
<td align="left">US</td>
<td align="left">5.7%</td>
<td align="left">2.8%</td>
<td align="left">1.4%</td>
<td align="left">0.7%</td>
</tr>
<tr class="odd">
<td align="left">ideaths</td>
<td align="left">US</td>
<td align="left">19.3%</td>
<td align="left">1%</td>
<td align="left">6.6%</td>
<td align="left">3.2%</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by VP Nagraj, Stephen Turner, Stephanie Guertin, Chris Hulme-Lowe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
